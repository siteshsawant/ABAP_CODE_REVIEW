*&---------------------------------------------------------------------*
*&  Include           ZKPIFOT_TOP
*&---------------------------------------------------------------------*
TABLES: EQUI.
SELECTION-SCREEN BEGIN OF BLOCK SEL WITH FRAME.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT (15) T1.
PARAMETERS: P_EQUIP TYPE EQUI-EQUNR OBLIGATORY.
PARAMETERS: P_PLANT TYPE VIAUFKS-WERKS.
SELECTION-SCREEN COMMENT (5) T8.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT (15) T2.
PARAMETERS : P_MONTH(2) TYPE N AS LISTBOX VISIBLE LENGTH 10 OBLIGATORY.
SELECTION-SCREEN COMMENT (1) T6.
PARAMETERS : P_YEAR(4)  TYPE N AS LISTBOX VISIBLE LENGTH 10 OBLIGATORY.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT (15) T3.
PARAMETERS: P_WEEK(2) TYPE N AS LISTBOX VISIBLE LENGTH 10.
SELECTION-SCREEN COMMENT (1) T7.
PARAMETERS: P_SUN AS CHECKBOX USER-COMMAND SUN.
SELECTION-SCREEN COMMENT (15) T4.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT (15) T5.
PARAMETERS: P_HOURS(2) TYPE N AS LISTBOX VISIBLE LENGTH 10.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK SEL.

TYPES: BEGIN OF LINETYPE,
         SIGN   TYPE C LENGTH 1,
         OPTION TYPE C LENGTH 2,
         LOW    TYPE SY-DATUM,
         HIGH   TYPE SY-DATUM,
         WEEK   TYPE C,
         WCOUNT TYPE C,
       END OF LINETYPE.

TYPES: BEGIN OF TY_WO,
         WEEKNO TYPE CHAR2,
         AUFNR  TYPE AUFK-AUFNR,
         AUART  TYPE AUFK-AUART,
         EQUNR  TYPE EQUI-EQUNR,
         EQKTX  TYPE EQKT-EQKTU,
       END OF TY_WO.

TYPES: BEGIN OF TY_JEST,
        OBJNR TYPE JEST-OBJNR,
        STAT TYPE JEST-STAT,
        INACT TYPE JEST-INACT,
      END OF TY_JEST.


DATA: LT_WEEK    TYPE TABLE OF LINETYPE WITH HEADER LINE,
      LT_WO      TYPE TABLE OF TY_WO WITH HEADER LINE,
      LT_SUBLIST TYPE TABLE OF TY_WO WITH HEADER LINE,
      LT_VIAUFKS TYPE TABLE OF VIAUFKS WITH HEADER LINE,
      LT_JEST    TYPE   TABLE OF TY_JEST WITH HEADER LINE.



DATA: DD(2)     TYPE C,LOOPS(2)   TYPE C, MM(2) TYPE C, YEAR(4) TYPE C, TEMP_WEEK LIKE SCAL-WEEK, WEEK1 LIKE SCAL-WEEK, WEEK2 LIKE SCAL-WEEK, DATE1 TYPE SY-DATUM, DATE2 TYPE SY-DATUM.
DATA: SWEEK(2) TYPE C, EWEEK(2) TYPE C.
DATA : W_DATE  TYPE D, W_LDATE TYPE D.
DATA: WEEKNO TYPE CHAR1,
      WOP    TYPE INT4.

TYPES: BEGIN OF TY_FINAL,
         WEEK          TYPE STRING,
         EQUNR         TYPE VIAUFKS-EQUNR,
         WOCOUNT       TYPE INT4,
         HOURS         TYPE INT4,
         MTBF          TYPE INT4,
         LINE_COLOR(4) TYPE C,
       END OF TY_FINAL.

DATA: TOTAL_WO   TYPE CHAR4,
      TOTAL_HR   TYPE CHAR4,
      TOTAL_MTBF TYPE CHAR4,
      TOTAL_TEXT TYPE CHAR10.

DATA: LT_FINAL TYPE TABLE OF TY_FINAL WITH HEADER LINE.

DATA: WA_FCAT      TYPE SLIS_FIELDCAT_ALV,
      IT_FCAT      TYPE SLIS_T_FIELDCAT_ALV,
      WA_FCAT2     TYPE SLIS_FIELDCAT_ALV,
      IT_FCAT2     TYPE SLIS_T_FIELDCAT_ALV,
      WA_SEL       TYPE SLIS_SELFIELD,
      "ALV layout work area
      WA_LAYOUT    TYPE SLIS_LAYOUT_ALV,

      "Key information for hierarchical list
      WA_KEY       TYPE SLIS_KEYINFO_ALV,
      GD_TAB_GROUP TYPE SLIS_T_SP_GROUP_ALV,
      GD_LAYOUT    TYPE SLIS_LAYOUT_ALV,
      GD_LAYOUT2   TYPE SLIS_LAYOUT_ALV,
      IT_SORT      TYPE SLIS_T_SORTINFO_ALV WITH HEADER LINE,
      WA_SORT      TYPE SLIS_T_SORTINFO_ALV,
      IT_SORT2     TYPE SLIS_T_SORTINFO_ALV WITH HEADER LINE,
      WA_SORT2     TYPE SLIS_T_SORTINFO_ALV.
